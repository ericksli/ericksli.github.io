<!doctype html><html lang=zh-tw dir=auto><head><meta name=generator content="Hugo 0.141.0"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>EricLog</title>
<meta name=description content><meta name=author content><link rel=canonical href=https://eric.swiftzer.net/><link crossorigin=anonymous href=/assets/css/stylesheet.6af4cf50660ceaa7cb5315be4c4bf349a5f8e72eee8939bab4dd32dcf0378f25.css integrity="sha256-avTPUGYM6qfLUxW+TEvzSaX45y7uiTm6tN0y3PA3jyU=" rel="preload stylesheet" as=style><link rel=icon href=https://eric.swiftzer.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://eric.swiftzer.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://eric.swiftzer.net/favicon-32x32.png><link rel=apple-touch-icon href=https://eric.swiftzer.net/apple-touch-icon.png><link rel=mask-icon href=https://eric.swiftzer.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://eric.swiftzer.net/index.xml><link rel=alternate hreflang=zh-tw href=https://eric.swiftzer.net/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=JetBrains+Mono:wght@300&display=swap" rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=G-D93F946T73"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-D93F946T73")}</script><meta property="og:url" content="https://eric.swiftzer.net/"><meta property="og:site_name" content="EricLog"><meta property="og:title" content="EricLog"><meta property="og:locale" content="zh-tw"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="EricLog"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"EricLog","url":"https://eric.swiftzer.net/","description":"","logo":"https://eric.swiftzer.net/favicon.ico","sameAs":["https://telegram.me/ericksli","https://twitter.com/ericksli","https://www.instagram.com/ericksli","https://500px.com/ericksli","https://medium.com/@ericksli","https://github.com/ericksli","https://www.linkedin.com/in/ericksli/","https://play.google.com/store/apps/dev?id=7993122800343932498"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://eric.swiftzer.net/ accesskey=h title="EricLog (Alt + H)">EricLog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://eric.swiftzer.net/fonts/ title=Fonts><span>Fonts</span></a></li><li><a href=https://eric.swiftzer.net/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://eric.swiftzer.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://eric.swiftzer.net/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 22：Whistle proxy</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 22 篇，你可到 iThome 查看原文。
文章目錄
由於我們在上一篇已經完成了成功載入班次的部分，接下來要做的當然是不正常的情況。雖然港鐵間中會有事故，但都可遇不可求。要檢查我們做的東西是不是正確除了寫自動化測試之外，既然我們都做到 UI 的部分那就當然要直接看實物更好吧。所以我們先換一換題目討論 proxy server。
...</p></div><footer class=entry-footer><span title='2021-10-07 00:00:00 +0800 +0800'>October 7, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 22：Whistle proxy" href=https://eric.swiftzer.net/2021/10/2021-ithome-ironman-22-whistle-proxy/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 21：ETA screen (1)</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 21 篇，你可到 iThome 查看原文。
文章目錄
現在來到整個 app 最重要的頁面：抵站時間頁。這個頁面基本上都是跟上一頁一樣，都是以 RecyclerView 為主。但因為這次的內容要從 API server 取得，即是說我們需要處理載入中、載入成功和載入失敗三個情景。當中載入成功時更要細分為顯示班次、事故和延誤三個情景。情況好像有點複雜，我們先看看各情景時的畫面：
...</p></div><footer class=entry-footer><span title='2021-10-06 00:00:00 +0800 +0800'>October 6, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 21：ETA screen (1)" href=https://eric.swiftzer.net/2021/10/2021-ithome-ironman-21-eta-screen-1/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 20：Station list screen (2)</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 20 篇，你可到 iThome 查看原文。
文章目錄
上一篇我們完成了 StationListAdapter，我們現在會繼續車站列表的 UI 部分。
...</p></div><footer class=entry-footer><span title='2021-10-05 00:00:00 +0800 +0800'>October 5, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 20：Station list screen (2)" href=https://eric.swiftzer.net/2021/10/2021-ithome-ironman-20-station-list-screen-2/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 19：Station list screen (1)</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 19 篇，你可到 iThome 查看原文。
文章目錄
最近兩篇都是講 navigation component，入面為了示範設定 navigation 我們已經預先準備了兩頁的 Fragment class 和 layout XML，這樣我們之後就不用再跳去設定 navigation 的東西。現在開始會開始正式實作 app 的界面部分。我們會由車站列表頁開始實作，現在看看完成品：
...</p></div><footer class=entry-footer><span title='2021-10-04 00:00:00 +0800 +0800'>October 4, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 19：Station list screen (1)" href=https://eric.swiftzer.net/2021/10/2021-ithome-ironman-19-station-list-screen-1/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 18：Navigation (2)</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 18 篇，你可到 iThome 查看原文。
文章目錄
在 Android，navigation graph 是 resource 的一種，我們先建立 eta.xml。
eta.xml 在 project 的位置 先附上完整的內容，然後再慢慢講解入面的意思。
...</p></div><footer class=entry-footer><span title='2021-10-03 00:00:00 +0800 +0800'>October 3, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 18：Navigation (2)" href=https://eric.swiftzer.net/2021/10/2021-ithome-ironman-18-navigation-2/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 17：Navigation (1)</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 17 篇，你可到 iThome 查看原文。
文章目錄
經過了兩個多星期後，我們終於開始進入 presentation layer 的部分。Presentation layer 就是做 UI 相關的東西，例如 Activity、Fragment、ViewModel 這些 class。而這次要做的部分是要準備基本的 navigation。
...</p></div><footer class=entry-footer><span title='2021-10-02 00:00:00 +0800 +0800'>October 2, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 17：Navigation (1)" href=https://eric.swiftzer.net/2021/10/2021-ithome-ironman-17-navigation-1/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 16：Domain layer testing</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 16 篇，你可到 iThome 查看原文。
文章目錄
今天會為上一篇所寫的兩個 use case 加上 unit test。
GetLinesAndStationsUseCaseImplTest 這個 test 其實很簡單，因為本身就是直接把 EtaRepository 拿到的 Map return 出去，所以 unit test 我們只需 mock EtaRepository 的 getLinesAndStations 然後檢查 use case return 出來的 map 是不是跟我們 mock 出來的 getLinesAndStations return value 是否一致即可。
...</p></div><footer class=entry-footer><span title='2021-10-01 00:00:00 +0800 +0800'>October 1, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 16：Domain layer testing" href=https://eric.swiftzer.net/2021/10/2021-ithome-ironman-16-domain-layer-testing/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 15：Domain layer implementation</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 15 篇，你可到 iThome 查看原文。
文章目錄
經過這麼多集的 data layer 後，我們來到 domain layer。Domain layer 的用途是用來放 business logic，並向 presentation layer（即是 Activity、Fragment、ViewModel、layout XML 這層）提供一個表象 (façade) 去用跟 data 互動。你或許會問為甚麼我們不在 ViewModel 直接 call 之前寫好的 repository 而要經 domain layer，這是為了日後功能變更提供彈性。例如一個新聞 app 會有新聞列表頁跟新聞正文頁，當按下新聞列表的項目時就會進入正文頁。在正文頁按了收藏後返回列表頁就會發現剛才那個項目出現了一個收藏 icon。如果在 data layer 跟 presentation layer 之間直接接駁的話，那個列表頁在收藏狀態變動後自動更新的 logic 就會放入 ViewModel 內。（可能是正文頁在按下收藏 icon 時用 event bus 通知其他 ViewModel 去更新 UI。）如果再多幾個地方跟那個收藏狀態有關連的話那些觸發檢查更新的 code 就會放在各個 ViewModel 之中，日後收藏功能再有改動就很麻煩。另外，一些複雜的東西例如之前提及過的車費計算都不是單純在網路上 call API 然後稍加修飾就輸出去 UI 上，而是真的有 business logic 在 mobile app 內進行。那些 business logic 都是會放在 domain layer 入面。可能車費計算背後有很多的 class，但我們只外露幾個 use case 或者 interactor 讓 presentation layer call，這樣就把背後複雜的東西隱藏起來。
...</p></div><footer class=entry-footer><span title='2021-09-30 00:00:00 +0800 +0800'>September 30, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 15：Domain layer implementation" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-15-domain-layer-implementation/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 14：Flipper</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 14 篇，你可到 iThome 查看原文。
文章目錄
在繼續實作 domain layer 之前，我們會介紹一個方便日常開發的工具：Flipper。
Android Studio 有個功能是查看 HTTP request 和 UI layout，但有時不太方便。如果是查看 HTTP request 的話，有些人會用 proxy server 來截取 HTTP request 和 response。但有個問題是裝置要先安裝 proxy server 的 root certificate，而且部分 app 或 SDK 會做 cert pinning，駁了 proxy server 就用不到那些 app 或 SDK（Google Places SDK 會有這個問題）。
...</p></div><footer class=entry-footer><span title='2021-09-29 00:00:00 +0800 +0800'>September 29, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 14：Flipper" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-14-flipper/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 13：Data layer testing (4)</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 13 篇，你可到 iThome 查看原文。
文章目錄
上一篇示範了 Ktor mock engine 的設定和測試了如果出現 exception 時能否順利地處理。現在就測試 getEta 輸出班次的情景。
...</p></div><footer class=entry-footer><span title='2021-09-28 00:00:00 +0800 +0800'>September 28, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 13：Data layer testing (4)" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-13-data-layer-testing-4/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://eric.swiftzer.net/page/2/>«&nbsp;上一頁&nbsp;
</a><a class=next href=https://eric.swiftzer.net/page/4/>下一頁&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2025 <a href=https://eric.swiftzer.net/>EricLog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>