<!doctype html><html lang=zh-hant-hk dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Laravel 4 | EricLog</title>
<meta name=keywords content="Laravel,PHP">
<meta name=description content="我自己學習 PHP 其實都只是一年前開始，這是因為我選修了兩科關於 PHP 的科目。那時學的都是一些最基本的 PHP，製作 HTML 表單連驗證、修改、儲存到資料庫都是用同一個 PHP 檔案，內裏用幾個 if 來分隔開不同的部分，還會用 session 來重新填寫表單內容。現在回想起都覺得這種寫法非常嘔心，因為實在太長，而且夾雜着 PHP 和 HTML，自己寫完都不想再去看。">
<meta name=author content>
<link rel=canonical href=https://eric.swiftzer.net/2013/06/laravel-4/>
<link href=/assets/css/stylesheet.min.d1fc837a267f77f6ede89d1a89c4880a90c381d9e6673ad4a76a3ad1900b65f9.css integrity="sha256-0fyDeiZ/d/bt6J0aicSICpDDgdnmZzrUp2o60ZALZfk=" rel="preload stylesheet" as=style>
<link rel=icon href=https://eric.swiftzer.net/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://eric.swiftzer.net/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://eric.swiftzer.net/favicon-32x32.png>
<link rel=apple-touch-icon href=https://eric.swiftzer.net/apple-touch-icon.png>
<link rel=mask-icon href=https://eric.swiftzer.net/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.88.1">
<link rel=preconnect href=https://fonts.gstatic.com>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=JetBrains+Mono:wght@300&display=swap" rel=stylesheet>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-1268728-8','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<meta property="og:title" content="Laravel 4">
<meta property="og:description" content="我自己學習 PHP 其實都只是一年前開始，這是因為我選修了兩科關於 PHP 的科目。那時學的都是一些最基本的 PHP，製作 HTML 表單連驗證、修改、儲存到資料庫都是用同一個 PHP 檔案，內裏用幾個 if 來分隔開不同的部分，還會用 session 來重新填寫表單內容。現在回想起都覺得這種寫法非常嘔心，因為實在太長，而且夾雜着 PHP 和 HTML，自己寫完都不想再去看。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://eric.swiftzer.net/2013/06/laravel-4/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2013-06-04T00:01:06+08:00">
<meta property="article:modified_time" content="2013-06-04T00:01:06+08:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Laravel 4">
<meta name=twitter:description content="我自己學習 PHP 其實都只是一年前開始，這是因為我選修了兩科關於 PHP 的科目。那時學的都是一些最基本的 PHP，製作 HTML 表單連驗證、修改、儲存到資料庫都是用同一個 PHP 檔案，內裏用幾個 if 來分隔開不同的部分，還會用 session 來重新填寫表單內容。現在回想起都覺得這種寫法非常嘔心，因為實在太長，而且夾雜着 PHP 和 HTML，自己寫完都不想再去看。">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://eric.swiftzer.net/posts/"},{"@type":"ListItem","position":2,"name":"Laravel 4","item":"https://eric.swiftzer.net/2013/06/laravel-4/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Laravel 4","name":"Laravel 4","description":"我自己學習 PHP 其實都只是一年前開始，這是因為我選修了兩科關於 PHP 的科目。那時學的都是一些最基本的 PHP，製作 HTML 表單連驗證、修改、儲存到資料庫都是用同一個 PHP 檔案，內裏用幾個 if 來分隔開不同的部分，還會用 session 來重新填寫表單內容。現在回想起都覺得這種寫法非常嘔心，因為實在太長，而且夾雜着 PHP 和 HTML，自己寫完都不想再去看。\n","keywords":["Laravel","PHP"],"articleBody":"我自己學習 PHP 其實都只是一年前開始，這是因為我選修了兩科關於 PHP 的科目。那時學的都是一些最基本的 PHP，製作 HTML 表單連驗證、修改、儲存到資料庫都是用同一個 PHP 檔案，內裏用幾個 if 來分隔開不同的部分，還會用 session 來重新填寫表單內容。現在回想起都覺得這種寫法非常嘔心，因為實在太長，而且夾雜着 PHP 和 HTML，自己寫完都不想再去看。\n所以那時就試用 CodeIgniter 這套 PHP framework 來做 project，因為這些 Framework 都會替你分好 MVC，不用自己慢慢研究怎樣分，只要跟着它的習慣去寫就不會再有一個 PHP 檔做全部的動作。 過了幾個月之後，在 Nettuts+ 看到有關 Laravel 的介紹，覺得它不錯。它提供的 function 就算不看說明文件也可以大約估計到它的意思，而且說明文件簡單明瞭，大部分要用到的功能都會在說明文件中找到，不用查 API。據介紹 Laravel 是抄 Ruby on Rails 的特色，例如有：\n ActiveRecord：即是 Laravel 叫的 Eloquent ORM (Object Relational Mapping)，可以用簡單易明的語法來做 database CRUD，無需寫 SQL statement Migration：將 Database schema 的改動寫入 PHP 檔內，再用 Laravel 提供的 Artisan CLI 工具執行或者還原到上一個版本。方便和其他開發人員同步各自 database 的 schema，不用再 export SQL file Generate：透過 Laravel 4 的 Artisan CLI 工具產生 PHP 檔案（例如 Controller class、Model class、View 等等，Laravel 3 可以裝第三方的 command 來補上這個功能） Gems：Laravel 3 是用自家制式的 Bundle；Laravel 4 是用 Composer RESTful：可以做到 RESTful controller，Laravel 4 還新加了 Resource controller 再加上一堆常用的現成功能如 HTML 表單製作 helper class、表單驗証、登入系統、Blade template（Laravel 自家 Templating 格式）、Pagination、Routing 等等令開發時間加快。上月開站的 CityU GE 指南都是用 Laravel 3 寫的，再配 Twitter Bootstrap、Font Awesome 做 UI。  而 Laravel 4 (L4) 在上星期推出了 4.0.0 版，這個版本基本上是重新寫過。亦正因為它是重新寫過，大部分 Laravel 3 (L3) 的 Class 和 Function 都改了，如果要升級的話就要逐個 PHP 檔案改成 L4 的 Class 和 Function。除了加添更多新功能外，L4 最大的改變是轉用 Composer 來管理組件，整個 Framework 都是由不同的組件組合而成。如果不喜歡 Laravel 的作法可以裝原裝組件換成自己喜歡的，例如將 Blade 換做 Smarty。而 L4 本身亦用上了其他現成的組件，例如 Symfony、whoops!（L4 那個很漂亮的錯誤報告畫面就是用這個 Library 做出來的）、Swift Mailer 等等。組件的安裝和更新可以用 Composer 替你完成，不用再自己手動換檔案。另一樣比較明顯的變化是 L4 遵守 PSR-0 and PSR-1 標準，Class 名要用 StudlyCaps、Function 名要用 camelCase，和新的 PHP 5 class 或者 Java 一樣。幸好 CityU GE 指南的規模不大，三兩日就可以將原先的 code 升級成 L4。首先要大改的就是將原先的 snake_case variable / function / class 名按照 PSR-1 標準替換。其次是將 class / function 名變成 L4 的（因為有不少常用的 function 都改了 signature）。之後再到 Packagist 找尋 reCAPTCHA、RSS feed 和 Sitemap class 的組件取代原先的 L3 bundle，並用 Composer 加到 project 內。這個過程都算輕鬆，因為這些組件是一般常用的組件，很容易找到。\n  Laravel 4 改用 Composer 管理組件的安裝、更新及相依性   Laravel 3 和 Laravel 4 的用法上的改動可以參考 Jeffery Way 的 Laravel 4 Mastery 和 Jason Lewis 的 Laravel 4: Illuminating Your Laravel 3 Applications。不過因為這些影片和文章都是在 Beta 版時寫的，和正式版會有小量出入。以下是我升級 CityU GE 指南時主要遇到的變化：\nHTML、Form、Blade、Asset Management、i18n  L3 用來產生 HTML  tag 的 HTML::link()、HTML::link_to_route()、HTML::link_to_secure() 在 L4 變成了 global function link_to()、link_to_action() Form class 仍然存在，在 L4 beta 時曾傳出 L4 會取消 Form::open() 的傳入參數改為一個 associative array Asset class 已經消失，要自己找替代品，或者乾脆不用 Blade 的 @include() 易名為 @extends() Blade 的 @endsection 易名為 @stop（但不轉也可以用到，但上面的 @include 就一定要改） Blade 新增了{{{ }}} 語法，括在裏面的 variable 會做一次 HTML escape；而原有的 {{ }} 語法就和以前一樣不會 escape e() 這個 escape HTML entity 的 function 仍然存在 Lang class 已經可以支援單數 / 眾數 / 個別數量時會套用不同款的翻譯字串 L3 內 __() 這個模仿 gettext 的 functoin 在 L4 改為 trans() 和 trans_choice() 或者 Lang::get() 和 Lang::choice()  Pagination  Paginate 過的 variable 如果要取得本頁的行列的話 L3 是 foreach ($courses-results as $course) {...}；L4 則不用再加 results，即是 foreach ($courses as $course) {...} 因為上述的改動，如果要檢查 paginate 過的結果是否為空的話，要使用 if (!$courses-getTotal()) {...}  Route  新增了 resource controller：Route::resource()（可以方便做 RESTful API，它會自動產生 RESTful URL，並且會有 route name） 新增了 sub-domain routing 新增了 route prefix（即是網址中段的 directory 名），例如要做一個 admin section，不用再每個 admin section 的 route 加 /admin/，可以用 Route::group(array('prefix' = 'admin'), function() {...}) 包起所有 admin section 的 route  URL、Request、Response  URL::base() 這個 function 改為使用 URL::to('') L3 要取得目前這個 request 的 route name 是用 Request::route()-action['as'] 而 L4 是用 Route::currentRouteName() 要送出 HTTP 404、500 等 error，L3 是用 return Response::error('404') 而 L4 是用 return App::abort(404)  Raw Query、Eloquent、Migration  L3 raw query 的 DB::only() 在 L4 已經取消 L4 可以用到 transaction L3 要執行 raw query 是 DB::query() 而 L4 則分拆成 DB::select()、DB::insert()、DB::update()、DB::delete() 和 DB::statement Eloquent model 的 getter 和 setter function 的命名規則分別改為 getFooAttribute() 和 setFirstNameAttribute()，Foo 和 FirstName 是 database column 名（留意 column 名仍然是用 snake_case，所以 setFirstNameAttribute() 是對應 database table 的 first_name column） 新加了 database seed 功能，可以不用再將填測試或預設資料寫成 DB schema 的 migration，並且在有需要時才導入到資料庫中 經 Eloquent 取得的 created_at、updated_at 和 deleted_at column 不再是普通的 string，而是 extends 自 DateTime 的 Carbon object，它提供一些方便易用的 function 來切換顯示格式、運算和處理這些日期和時間  Artisan  新增了 php artisan serve，只要讓 console 開着的話就可以用 PHP 內置的網頁伺服器運行這個 Laravel project，可以不用設定 VirtualHost 新增了 php artisan controller:make，用來產生 resource controller 新增了 php artisan optimize，用來產生最佳化過的 class loader，加快載入速度 新增了 php artisan migrate:refresh，可以還原所有 migration 並重新執行所有 migration  其他  dd() 仍然可以使用 L4 目前未有內置 profiler bar (Anbu)，但可以用 loic-sharma/profiler 代替 其實還有很多的改變，只是我在這次升級未有遇到。要查 L4 的說明文件可以到 Laravel 官方網站，官方網站亦都有 L4 API。說明文件並沒有將所有 function 列出，如果要找一些比較少用的 function 就要到 API documentation 查。如果已經有 L3 的 project 的話，其實可以繼續用 L3。因為升級不只是換 Laravel 的核心檔案，還要逐個檔案去改。但如果是要開始一個新 project 的話，就最好用 L4。因為 L3 將會淡出，日後未必再有新的 L3 bundle 可以用。相反，L4 是用 Packagist，愈來愈多 PHP framework 都開始支援 Packagist / Composer，這意味着日後會有更多現成組件可以用，節省自己開發的時間。 ","wordCount":"2757","inLanguage":"en","datePublished":"2013-06-04T00:01:06+08:00","dateModified":"2013-06-04T00:01:06+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://eric.swiftzer.net/2013/06/laravel-4/"},"publisher":{"@type":"Organization","name":"EricLog","logo":{"@type":"ImageObject","url":"https://eric.swiftzer.net/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<noscript>
<style type=text/css>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://eric.swiftzer.net/ accesskey=h title="EricLog (Alt + H)">EricLog</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu onscroll=menu_on_scroll()>
<li>
<a href=https://eric.swiftzer.net/fonts/ title=Fonts>
<span>Fonts</span>
</a>
</li>
<li>
<a href=https://eric.swiftzer.net/archives/ title=Archives>
<span>Archives</span>
</a>
</li>
<li>
<a href=https://eric.swiftzer.net/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://eric.swiftzer.net/about/ title=About>
<span>About</span>
</a>
</li></ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs>
<a href=https://eric.swiftzer.net/>Home</a>&nbsp;»&nbsp;<a href=https://eric.swiftzer.net/posts/>Posts</a>
</div>
<h1 class=post-title>
Laravel 4
</h1>
<div class=post-meta>June 4, 2013
</div>
</header>
<div class=post-content>
<p>我自己學習 PHP 其實都只是一年前開始，這是因為我選修了兩科關於 PHP 的科目。那時學的都是一些最基本的 PHP，製作 HTML 表單連驗證、修改、儲存到資料庫都是用同一個 PHP 檔案，內裏用幾個 <code>if</code> 來分隔開不同的部分，還會用 session 來重新填寫表單內容。現在回想起都覺得這種寫法非常嘔心，因為實在太長，而且夾雜着 PHP 和 HTML，自己寫完都不想再去看。</p>
<p>所以那時就試用 <a href=http://ellislab.com/codeigniter>CodeIgniter</a> 這套 PHP framework 來做 project，因為這些 Framework 都會替你分好 MVC，不用自己慢慢研究怎樣分，只要跟着它的習慣去寫就不會再有一個 PHP 檔做全部的動作。 過了幾個月之後，在 <a href=http://net.tutsplus.com/>Nettuts+</a> 看到有關 <a href=http://laravel.com/>Laravel</a> 的介紹，覺得它不錯。它提供的 function 就算不看說明文件也可以大約估計到它的意思，而且說明文件簡單明瞭，大部分要用到的功能都會在說明文件中找到，不用查 API。據介紹 Laravel 是抄 <a href=http://rubyonrails.org/>Ruby on Rails</a> 的特色，例如有：</p>
<ul>
<li>ActiveRecord：即是 Laravel 叫的 Eloquent ORM (Object Relational Mapping)，可以用簡單易明的語法來做 database CRUD，無需寫 SQL statement</li>
<li>Migration：將 Database schema 的改動寫入 PHP 檔內，再用 Laravel 提供的 Artisan CLI 工具執行或者還原到上一個版本。方便和其他開發人員同步各自 database 的 schema，不用再 export SQL file</li>
<li>Generate：透過 Laravel 4 的 Artisan CLI 工具產生 PHP 檔案（例如 Controller class、Model class、View 等等，Laravel 3 可以裝第三方的 command 來補上這個功能）</li>
<li>Gems：Laravel 3 是用自家制式的 Bundle；Laravel 4 是用 <a href=http://getcomposer.org/>Composer</a></li>
<li><a href=http://zh.wikipedia.org/wiki/REST>RESTful</a>：可以做到 RESTful controller，Laravel 4 還新加了 Resource controller
再加上一堆常用的現成功能如 HTML 表單製作 helper class、表單驗証、登入系統、Blade template（Laravel 自家 Templating 格式）、Pagination、Routing 等等令開發時間加快。上月開站的 <a href=http://cityuge.swiftzer.net/>CityU GE 指南</a>都是用 Laravel 3 寫的，再配 <a href=http://twitter.github.io/bootstrap/>Twitter Bootstrap</a>、<a href=http://fortawesome.github.io/Font-Awesome/>Font Awesome</a> 做 UI。</li>
</ul>
<p>而 Laravel 4 (L4) 在上星期推出了 4.0.0 版，這個版本基本上是重新寫過。亦正因為它是重新寫過，大部分 Laravel 3 (L3) 的 Class 和 Function 都改了，如果要升級的話就要逐個 PHP 檔案改成 L4 的 Class 和 Function。除了加添更多新功能外，L4 最大的改變是轉用 Composer 來管理組件，整個 Framework 都是由不同的組件組合而成。如果不喜歡 Laravel 的作法可以裝原裝組件換成自己喜歡的，例如將 Blade 換做 <a href=http://www.smarty.net/>Smarty</a>。而 L4 本身亦用上了其他現成的組件，例如 <a href=http://symfony.com/>Symfony</a>、<a href=http://filp.github.io/whoops/>whoops!</a>（L4 那個很漂亮的錯誤報告畫面就是用這個 Library 做出來的）、<a href=http://swiftmailer.org/>Swift Mailer</a> 等等。組件的安裝和更新可以用 Composer 替你完成，不用再自己手動換檔案。另一樣比較明顯的變化是 L4 遵守 <a href=https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md>PSR-0</a> and <a href=https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-1-basic-coding-standard.md>PSR-1</a> 標準，Class 名要用 StudlyCaps、Function 名要用 camelCase，和新的 PHP 5 class 或者 Java 一樣。幸好 CityU GE 指南的規模不大，三兩日就可以將原先的 code 升級成 L4。首先要大改的就是將原先的 snake_case variable / function / class 名按照 PSR-1 標準替換。其次是將 class / function 名變成 L4 的（因為有不少常用的 function 都改了 signature）。之後再到 <a href=https://packagist.org/>Packagist</a> 找尋 reCAPTCHA、RSS feed 和 Sitemap class 的組件取代原先的 L3 bundle，並用 Composer 加到 project 內。這個過程都算輕鬆，因為這些組件是一般常用的組件，很容易找到。</p>
<figure>
<img loading=lazy src=laravel-composer.jpg> <figcaption>
Laravel 4 改用 Composer 管理組件的安裝、更新及相依性
</figcaption>
</figure>
<p>Laravel 3 和 Laravel 4 的用法上的改動可以參考 Jeffery Way 的 <a href=http://net.tutsplus.com/tutorials/php/laravel-4-mastery/>Laravel 4 Mastery</a> 和 Jason Lewis 的 <a href=http://jasonlewis.me/article/laravel-4-illuminating-your-laravel-3-applications>Laravel 4: Illuminating Your Laravel 3 Applications</a>。不過因為這些影片和文章都是在 Beta 版時寫的，和正式版會有小量出入。以下是我升級 CityU GE 指南時主要遇到的變化：</p>
<h2 id=htmlformbladeasset-managementi18n>HTML、Form、Blade、Asset Management、i18n<a hidden class=anchor aria-hidden=true href=#htmlformbladeasset-managementi18n>#</a></h2>
<ul>
<li>L3 用來產生 HTML <code>&lt;a></code> tag 的 <code>HTML::link()</code>、<code>HTML::link_to_route()</code>、<code>HTML::link_to_secure()</code> 在 L4 變成了 global function <code>link_to()</code>、<code>link_to_action()</code></li>
<li><code>Form</code> class 仍然存在，在 L4 beta 時曾傳出 L4 會取消</li>
<li><code>Form::open()</code> 的傳入參數改為一個 associative array</li>
<li><code>Asset</code> class 已經消失，要自己找替代品，或者乾脆不用</li>
<li>Blade 的 <code>@include()</code> 易名為 <code>@extends()</code></li>
<li>Blade 的 <code>@endsection</code> 易名為 <code>@stop</code>（但不轉也可以用到，但上面的 <code>@include</code> 就一定要改）</li>
<li>Blade 新增了<code>{{{ }}}</code> 語法，括在裏面的 variable 會做一次 HTML escape；而原有的 <code>{{ }}</code> 語法就和以前一樣不會 escape</li>
<li><code>e()</code> 這個 escape HTML entity 的 function 仍然存在</li>
<li><code>Lang</code> class 已經可以支援單數 / 眾數 / 個別數量時會套用不同款的翻譯字串</li>
<li>L3 內 <code>__()</code> 這個模仿 gettext 的 functoin 在 L4 改為 <code>trans()</code> 和 <code>trans_choice()</code> 或者 <code>Lang::get()</code> 和 <code>Lang::choice()</code></li>
</ul>
<h2 id=pagination>Pagination<a hidden class=anchor aria-hidden=true href=#pagination>#</a></h2>
<ul>
<li>Paginate 過的 variable 如果要取得本頁的行列的話 L3 是 <code>foreach ($courses->results as $course) {...}</code>；L4 則不用再加 <code>results</code>，即是 <code>foreach ($courses as $course) {...}</code></li>
<li>因為上述的改動，如果要檢查 paginate 過的結果是否為空的話，要使用 <code>if (!$courses->getTotal()) {...}</code></li>
</ul>
<h2 id=route>Route<a hidden class=anchor aria-hidden=true href=#route>#</a></h2>
<ul>
<li>新增了 resource controller：<code>Route::resource()</code>（可以方便做 RESTful API，它會自動產生 RESTful URL，並且會有 route name）</li>
<li>新增了 sub-domain routing</li>
<li>新增了 route prefix（即是網址中段的 directory 名），例如要做一個 admin section，不用再每個 admin section 的 route 加 <code>/admin/</code>，可以用 <code>Route::group(array('prefix' => 'admin'), function() {...})</code> 包起所有 admin section 的 route</li>
</ul>
<h2 id=urlrequestresponse>URL、Request、Response<a hidden class=anchor aria-hidden=true href=#urlrequestresponse>#</a></h2>
<ul>
<li><code>URL::base()</code> 這個 function 改為使用 <code>URL::to('')</code></li>
<li>L3 要取得目前這個 request 的 route name 是用 <code>Request::route()->action['as']</code> 而 L4 是用 <code>Route::currentRouteName()</code></li>
<li>要送出 HTTP 404、500 等 error，L3 是用 <code>return Response::error('404')</code> 而 L4 是用 <code>return App::abort(404)</code></li>
</ul>
<h2 id=raw-queryeloquentmigration>Raw Query、Eloquent、Migration<a hidden class=anchor aria-hidden=true href=#raw-queryeloquentmigration>#</a></h2>
<ul>
<li>L3 raw query 的 <code>DB::only()</code> 在 L4 已經取消</li>
<li>L4 可以用到 transaction</li>
<li>L3 要執行 raw query 是 <code>DB::query()</code> 而 L4 則分拆成 <code>DB::select()</code>、<code>DB::insert()</code>、<code>DB::update()</code>、<code>DB::delete()</code> 和 <code>DB::statement</code></li>
<li>Eloquent model 的 getter 和 setter function 的命名規則分別改為 <code>getFooAttribute()</code> 和 <code>setFirstNameAttribute()</code>，<code>Foo</code> 和 <code>FirstName</code> 是 database column 名（留意 column 名仍然是用 snake_case，所以 <code>setFirstNameAttribute()</code> 是對應 database table 的 <code>first_name</code> column）</li>
<li>新加了 database seed 功能，可以不用再將填測試或預設資料寫成 DB schema 的 migration，並且在有需要時才導入到資料庫中</li>
<li>經 Eloquent 取得的 <code>created_at</code>、<code>updated_at</code> 和 <code>deleted_at</code> column 不再是普通的 string，而是 extends 自 <code>DateTime</code> 的 <a href=https://github.com/briannesbitt/Carbon>Carbon</a> object，它提供一些方便易用的 function 來切換顯示格式、運算和處理這些日期和時間</li>
</ul>
<h2 id=artisan>Artisan<a hidden class=anchor aria-hidden=true href=#artisan>#</a></h2>
<ul>
<li>新增了 <code>php artisan serve</code>，只要讓 console 開着的話就可以用 PHP 內置的網頁伺服器運行這個 Laravel project，可以不用設定 VirtualHost</li>
<li>新增了 <code>php artisan controller:make</code>，用來產生 resource controller</li>
<li>新增了 <code>php artisan optimize</code>，用來產生最佳化過的 class loader，加快載入速度</li>
<li>新增了 <code>php artisan migrate:refresh</code>，可以還原所有 migration 並重新執行所有 migration</li>
</ul>
<h2 id=其他>其他<a hidden class=anchor aria-hidden=true href=#其他>#</a></h2>
<ul>
<li><code>dd()</code> 仍然可以使用</li>
<li>L4 目前未有內置 profiler bar (Anbu)，但可以用 <a href=https://packagist.org/packages/loic-sharma/profiler>loic-sharma/profiler</a> 代替
其實還有很多的改變，只是我在這次升級未有遇到。要查 L4 的說明文件可以到 <a href=http://laravel.com/docs>Laravel 官方網站</a>，官方網站亦都有 L4 <a href=https://laravel.com/api/4.2/>API</a>。說明文件並沒有將所有 function 列出，如果要找一些比較少用的 function 就要到 API documentation 查。如果已經有 L3 的 project 的話，其實可以繼續用 L3。因為升級不只是換 Laravel 的核心檔案，還要逐個檔案去改。但如果是要開始一個新 project 的話，就最好用 L4。因為 L3 將會淡出，日後未必再有新的 L3 bundle 可以用。相反，L4 是用 Packagist，愈來愈多 PHP framework 都開始支援 Packagist / Composer，這意味着日後會有更多現成組件可以用，節省自己開發的時間。</li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://eric.swiftzer.net/tags/laravel/>Laravel</a></li>
<li><a href=https://eric.swiftzer.net/tags/php/>PHP</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://eric.swiftzer.net/2013/06/laraval-4-chinese-translation/>
<span class=title>« Prev Page</span>
<br>
<span>Laraval 4 中文語系翻譯</span>
</a>
<a class=next href=https://eric.swiftzer.net/2013/05/bitbucket-free-academic-license/>
<span class=title>Next Page »</span>
<br>
<span>Bitbucket 免費 Academic License</span>
</a>
</nav>
</footer><div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//efilm.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</article>
</main><footer class=footer>
<span>&copy; 2021 <a href=https://eric.swiftzer.net/>EricLog</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)">
<button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</button>
</a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>