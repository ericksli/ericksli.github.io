<!doctype html><html lang=zh-tw dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Android | EricLog</title>
<meta name=keywords content><meta name=description content><meta name=author content><link rel=canonical href=https://eric.swiftzer.net/tags/android/><link crossorigin=anonymous href=/assets/css/stylesheet.90d199bcefc47701be1700bdf90111f08c9ec8cafb7121eac1388d2f16c2cb69.css integrity="sha256-kNGZvO/EdwG+FwC9+QER8IyeyMr7cSHqwTiNLxbCy2k=" rel="preload stylesheet" as=style><link rel=icon href=https://eric.swiftzer.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://eric.swiftzer.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://eric.swiftzer.net/favicon-32x32.png><link rel=apple-touch-icon href=https://eric.swiftzer.net/apple-touch-icon.png><link rel=mask-icon href=https://eric.swiftzer.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://eric.swiftzer.net/tags/android/index.xml><link rel=alternate hreflang=zh-tw href=https://eric.swiftzer.net/tags/android/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=JetBrains+Mono:wght@300&display=swap" rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=G-D93F946T73"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-D93F946T73")}</script><meta property="og:url" content="https://eric.swiftzer.net/tags/android/"><meta property="og:site_name" content="EricLog"><meta property="og:title" content="Android"><meta property="og:locale" content="zh-tw"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Android"><meta name=twitter:description content></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://eric.swiftzer.net/ accesskey=h title="EricLog (Alt + H)">EricLog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://eric.swiftzer.net/fonts/ title=Fonts><span>Fonts</span></a></li><li><a href=https://eric.swiftzer.net/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://eric.swiftzer.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://eric.swiftzer.net/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://eric.swiftzer.net/>首頁</a>&nbsp;»&nbsp;<a href=https://eric.swiftzer.net/tags/>Tags</a></div><h1>Android</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 11：Data layer testing (2)</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 11 篇，你可到 iThome 查看原文。
文章目錄
今天會繼續寫 EtaResponseMapperTest。我們示範的 test case 是正常輸出班次的情景。首先是準備 response：
...</p></div><footer class=entry-footer><span title='2021-09-26 00:00:00 +0800 +0800'>September 26, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 11：Data layer testing (2)" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-11-data-layer-testing-2/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 10：Data layer testing (1)</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 10 篇，你可到 iThome 查看原文。
文章目錄
在切回去寫 domain layer 之前，我們先把之前寫好的 data layer class 補回 unit test。在開始寫之前，我們要先加入一些 testing 會用到的 dependency（Strikt 和 MockK）：
...</p></div><footer class=entry-footer><span title='2021-09-25 00:00:00 +0800 +0800'>September 25, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 10：Data layer testing (1)" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-10-data-layer-testing-1/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 9：Date & time</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 9 篇，你可到 iThome 查看原文。
文章目錄
上一篇在實作 EtaResponseMapper 的時候我們用了 Java 8 開始有的 Instant、LocalDateTime 和 ZonedDateTime。它們都是跟日期時間相關的 class。但其實 Kotlin 都有 kotlinx-datetime 做類似的東西。但目前 kotlinx-datetime 還是在早期開發階段，有很多常用功能都未做到，例如我們這次需要用到的 formatter 目前仍需要用 Java time，所以還是用 Java time 算。
...</p></div><footer class=entry-footer><span title='2021-09-24 00:00:00 +0800 +0800'>September 24, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 9：Date & time" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-09-date-time/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 8：Data layer implementation (2)</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 8 篇，你可到 iThome 查看原文。
文章目錄
上一篇的 repository 還欠一個 mapper 把 EtaResponse 轉成 EtaResult。我們首先準備一個通用的 interface：
interface Mapper&lt;T, R> { suspend fun map(o: T): R } 有些 Android Clean Architecture 會每個 layer 都準備一個對應的 mapper interface，這次示範我們就簡化這一部分，全部 layer 都共用同一個 mapper interface，不論是由高層次 layer 去低層次 layer 還是由低層次 layer 去高層次 layer 都一樣。因為這個 mapper 都是為了在寫 unit test 時可以 mock 那個 interface 而不是 mock 那個 concrete implementation，所以它是不是共用 interface 問題不大。
...</p></div><footer class=entry-footer><span title='2021-09-23 00:00:00 +0800 +0800'>September 23, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 8：Data layer implementation (2)" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-08-data-layer-implementation-2/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 7：Data layer implementation (1)</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 7 篇，你可到 iThome 查看原文。
文章目錄
在上一篇，我們把 Ktor client 加到 Dagger 的 object graph 內。現在我們就繼續寫 data layer 部分。
跨 layer 共用部分 不過在繼續之前，我們要先準備一些通用的 enum。這些 enum 分別是用來表示路綫、車站和語言。因為這次的示範 app 所用到的車站和路綫的數量有限，我們就簡化用 enum 寫死在 app 入面就算了，但如果數量多的話或許會改用 SQLite database 之類去儲存它們。在這種情況下，我們一般都會每個 layer 都有對應的 data class 表示，而不會好像現在把 data class/enum 放在 common 的地方。
...</p></div><footer class=entry-footer><span title='2021-09-22 00:00:00 +0800 +0800'>September 22, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 7：Data layer implementation (1)" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-07-data-layer-implementation-1/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 6：HTTP Client</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 6 篇，你可到 iThome 查看原文。
文章目錄
在 Android 開發如果要用到 HTTP client 的話基本上大家都預設用 OkHttp + Retrofit 這個組合。這次我們試試一些新東西：Ktor。
...</p></div><footer class=entry-footer><span title='2021-09-21 00:00:00 +0800 +0800'>September 21, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 6：HTTP Client" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-06-http-client/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 5：Dependency injection</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 5 篇，你可到 iThome 查看原文。
文章目錄
談到 Android 的 dependency injection (DI)，大家一定會想到 Dagger 這個 DI library。因為 Dagger 2 是由 Google 開發，加上在 Android Developers 網站有對應的教學文章，所以成為不二之選。不過 Dagger 向來都有難學的印象，尤其是在以前 Dagger 2 網站那個惡名昭彰的咖啡機教學。本來用咖啡機來說明 DI 的概念就沒有甚麼大問題，問題在於看完那個咖啡機類比是不會知道如何在 Android app 上套用那些概念和 Dagger 提供的功能。或許大家讀電腦科學／計算機科學／資訊工程之類的課程時都有學過 DI 但還是不能順利地用 Dagger，這是因為 Android 那些組件的 constructor 不是由我們去 call，結果要在 onCreate 之類的 callback 加上 DI library 要我們寫的 code 才能拿到我們要用的 dependency。
...</p></div><footer class=entry-footer><span title='2021-09-20 00:00:00 +0800 +0800'>September 20, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 5：Dependency injection" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-05-dependency-injection/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 4：Deserialization</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 4 篇，你可到 iThome 查看原文。
文章目錄
JSON serialization/deserialization 應該是不少 Android app 都會做的事，基本上近乎每個 Android project 都會用了一個或幾個這些 library，而 Android 都有好幾個選擇。除了上一篇提過的 org.json 套件之外，Gson、Moshi 和 Kotlin serialization 都是熱門的選擇。
...</p></div><footer class=entry-footer><span title='2021-09-19 00:00:00 +0800 +0800'>September 19, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 4：Deserialization" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-04-deserialization/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 3：Endpoint</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 3 篇，你可到 iThome 查看原文。
文章目錄
我們用到的 API endpoint 只有一個，就是用來取得港鐵機場快綫、東涌綫、屯馬綫及將軍澳綫最多四班即將到站列車的抵達時間。車站清單我們會直接寫死在 app 裏面。API 的使用方法可以在資料一線通網站（香港政府 open data 的網站）內找到。這個 API 是不需要額外申請 API key，只是一個普通的 HTTP GET request，然後 response body 是一個 JSON object。
...</p></div><footer class=entry-footer><span title='2021-09-18 00:00:00 +0800 +0800'>September 18, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 3：Endpoint" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-03-endpoint/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2021 iThome 鐵人賽 Day 2：Architecture</h2></header><div class=entry-content><p>本篇文章是 2021 iThome 鐵人賽參賽題目「寫一個列車抵站時間 Android App」的第 2 篇，你可到 iThome 查看原文。
文章目錄
Architecture Components 以前 Android Developers 網站沒有特別提及過寫 Android app 應該用甚麼 architecture，直至到近年 Google 因應社群的要求才建議使用 MVVM並推出了對應 MVVM 的 Architecture Components library。下圖是 Android Developers 網站建議的 architecture：
...</p></div><footer class=entry-footer><span title='2021-09-17 00:00:00 +0800 +0800'>September 17, 2021</span></footer><a class=entry-link aria-label="post link to 2021 iThome 鐵人賽 Day 2：Architecture" href=https://eric.swiftzer.net/2021/09/2021-ithome-ironman-02-architecture/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://eric.swiftzer.net/tags/android/page/3/>«&nbsp;上一頁&nbsp;
</a><a class=next href=https://eric.swiftzer.net/tags/android/page/5/>下一頁&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2025 <a href=https://eric.swiftzer.net/>EricLog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>