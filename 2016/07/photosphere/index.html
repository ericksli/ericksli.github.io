<!doctype html><html lang=zh-tw dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Photosphere | EricLog</title><meta name=keywords content="Photography,Photosphere,Photoshop"><meta name=description content="早前 Facebook 的 360 Photos 令 Photosphre 流行起來。沒有 360 camera 的話，可以用手機應用程式駁相。不過用手機影相畫質會比較差。所以這次試試用相機拍攝 Photosphere。 以"><meta name=author content><link rel=canonical href=https://eric.swiftzer.net/2016/07/photosphere/><link crossorigin=anonymous href=/assets/css/stylesheet.min.249b1770ac429c01ffa746cc012a310192d174c913b1527f312e3294a0766d1c.css integrity="sha256-JJsXcKxCnAH/p0bMASoxAZLRdMkTsVJ/MS4ylKB2bRw=" rel="preload stylesheet" as=style><link rel=icon href=https://eric.swiftzer.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://eric.swiftzer.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://eric.swiftzer.net/favicon-32x32.png><link rel=apple-touch-icon href=https://eric.swiftzer.net/apple-touch-icon.png><link rel=mask-icon href=https://eric.swiftzer.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.101.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=JetBrains+Mono:wght@300&display=swap" rel=stylesheet><script async src="https://www.googletagmanager.com/gtag/js?id=G-D93F946T73"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-D93F946T73",{anonymize_ip:!1})}</script><meta property="og:title" content="Photosphere"><meta property="og:description" content="早前 Facebook 的 360 Photos 令 Photosphre 流行起來。沒有 360 camera 的話，可以用手機應用程式駁相。不過用手機影相畫質會比較差。所以這次試試用相機拍攝 Photosphere。 以"><meta property="og:type" content="article"><meta property="og:url" content="https://eric.swiftzer.net/2016/07/photosphere/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-07-31T23:30:52+08:00"><meta property="article:modified_time" content="2016-07-31T23:30:52+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Photosphere"><meta name=twitter:description content="早前 Facebook 的 360 Photos 令 Photosphre 流行起來。沒有 360 camera 的話，可以用手機應用程式駁相。不過用手機影相畫質會比較差。所以這次試試用相機拍攝 Photosphere。 以"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://eric.swiftzer.net/posts/"},{"@type":"ListItem","position":2,"name":"Photosphere","item":"https://eric.swiftzer.net/2016/07/photosphere/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Photosphere","name":"Photosphere","description":"早前 Facebook 的 360 Photos 令 Photosphre 流行起來。沒有 360 camera 的話，可以用手機應用程式駁相。不過用手機影相畫質會比較差。所以這次試試用相機拍攝 Photosphere。 以","keywords":["Photography","Photosphere","Photoshop"],"articleBody":"早前 Facebook 的 360 Photos 令 Photosphre 流行起來。沒有 360 camera 的話，可以用手機應用程式駁相。不過用手機影相畫質會比較差。所以這次試試用相機拍攝 Photosphere。\n以下是所需工具：\n有全手動模式的相機 魚眼鏡 / 廣角鏡 三腳架 Hugin Photoshop 能修改檔案 XMP 的工具 器材 按照 Google 的指引，用 DSLR 拍攝 Photosphere 的話，是需要用魚眼鏡。但因為我沒有魚眼鏡的關係，所以唯有用 14-42mm kit 鏡（135 等效焦距 28mm）拍攝。用魚眼鏡拍攝的好處是因為視角夠廣，拍攝張數少，後期駁相都會比較方便。但由於沒有魚眼鏡的關係所以拍了 70 多張相來接駁。拍攝時要調去全手動模式 (M mode)，對焦設成無限遠，ISO、光圈、快門、白平衡都要手動固定，否則接駁時可能會有明顥光暗差異。\n緊記要用三腳架以確保位置固定在一個點。如果要講夠的話可以用全景雲台，但就算不用效果也是可以的。拍攝時要確保相片之間要預留足夠的重疊位置。PhotosphereViewer.net 提供了一個建議可以作參考：相機垂直，分 7 行影，水平角度影 14 張，之後慢慢將相機角度調向天上分別影 12 張、6 張、1 張，然後向地面做相同動作。不過拍到底部時要拿走腳架才拍。\n後製 Hugin 是一個開源的全景圖接駁軟件，它能支援不同的投射方式 (projection)。它支援 Photosphere 的 2:1 equirectangular projection。\n開啟 Hugin 之後，可以先加入水平角度影的一行相片讓它自動接駁。用水平角度影的一行應該是最易接駁。留意要設定好鏡頭的焦距，因為它會按照焦距來將相片投射到球體內。如果相片見到腳架的話，可以Hugin 內置了不同的算法來尋找兩張圖的共通點，將相片加到 project 之後應該先用那些算法自動做一次先（揀選相片，然後按 Create control points 按鈕），如果效果不好才自己手動逐個共通點標註。留意揀選相片再按 Create control points 按鈕這個步驟要以人手揀選不同的相片組合再按 Create control points 按鈕。因為它有時不會尋找跨行相片的共通點。駁了大約一行後可以按一下 Optimize 部分的 calculate 按鈕，讓它計算相片的位置。\n這個步驟的目標就是要「織網」：即是將不同的相片以共通點連接，連接不單止是同一行，還要跨行。否則相片不能接駁成球體。要查看「織網」的效果，按一下 Fast panorama preview 按鈕（頂部寫有 GL 的按鈕），再轉到 Layout tab 就可以看到。如果「織網」效果不滿意，可以返回 Panorama Stitcher 視窗再揀選未有連結的兩張圖，再按一下 Create control points 按鈕。如果一次過揀選太多圖片來找共通點的話可能「織網」時會有遺漏。\n之後可以轉到 Preview tab 預覧效果。如果滿意的話可以將圖片匯出。留意匯出的圖片太大的話可能會因記憶體不足而失敗。匯出完成後可以用 PhotosphereViewer.net 預覽。\n預覽時可能會發現頂部和底部都不能完全填滿﹑還見到小小腳架，或者端點駁位特別明顯，但用 Photoshop 修補又很難。Equirectangular projection 的特點就是頂部 (zenith) 和底部 (nadir) 會嚴重變形，如果直接修改的話會非常困難。所以這時要用 The Domemaster Photoshop Actions Pack Photoshop action 將頂部和底部還原。\n裝好 The Domemaster Photoshop Actions Pack 之後，開啟之前匯出好的全景相，然後複製多一個文件出來 (Image | Duplicate)。如果要修改底部的話，就要先將圖片 180 度反轉。之後在 Action 面板選擇「2:1 Equirectangular to Angular Fisheye」。還原後會變成一個圓形的圖片，這時就可以用平時慣用的工具（例如 Clone stamp tool）來修補。如果懶的話可以放一個圓形的圖案遮蓋住底部，圖案可以是你的 logo 或者指南針之類。改好之後就合併所有圖層，之後在 Action 面板選擇「Angular Fisheye to 2:1 Equirectangular」。圖片就會變成 equirectangular projection，這就可以將該圖片放回原先的全景圖內。留意相片尺寸不可以太大，否則 Photoshop 不能處理。還有做完 Angular Fisheye to 2:1 Equirectangular Action 後圖片會被拉高，只需在放上去原圖時將高度縮小一半就可以了。\n最後就是為全景圖加上 Photosphere XMP metadata。我自己就用 Adobe Bridge 的面板加上 data panel 來加工，但其實可以用其他改 EXIF 和 XMP 軟件修改。除了 Photosphere XMP metadata 外，還可以加上相片拍攝位置的座標，方便分享到 Google Maps、Facebook、Flickr 等等的網站。Photosphere XMP metadata 有一項叫 PoseHeadingDegrees 是用來指明北面是在那方，但在 Facebook 試過發現它好像沒有用到這個數值。所以最好的方法都是在 Hugin 裏調節好方向。只需在 Hugin 的 Fast panorama preview 視窗按「Move/Drag」tab，然後按住 Shift 的同時左右 drag 全景圖就可以調整方向，將北面的景放到整張全景點的正中央就可以了。下面就是完成品（因為我之前已經上載了，所以沒有再修正方向問題）：\n其實可以見到 Hugin 會駁錯，可能是因為用了太多相片去駁，加上可能 Hugin 算法找錯共通點（大廈外牆其實層層都差不多，差異主要是在窗門曬的衣服和冷氣機；地磚就更難駁）。如果要用人手修正 / 補加共通點會花太多時間。如果想大量拍攝 Photosphere 的話最好都是買一支魚眼鏡。\n參考 making360 - Patching Nadir Photo Sphere XMP 中繼資料 How to add mandatory Photo Sphere meta data to an equirectangular image (Photoshop CC 2014) ","wordCount":"1862","inLanguage":"zh-tw","datePublished":"2016-07-31T23:30:52+08:00","dateModified":"2016-07-31T23:30:52+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://eric.swiftzer.net/2016/07/photosphere/"},"publisher":{"@type":"Organization","name":"EricLog","logo":{"@type":"ImageObject","url":"https://eric.swiftzer.net/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://eric.swiftzer.net/ accesskey=h title="EricLog (Alt + H)">EricLog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://eric.swiftzer.net/fonts/ title=Fonts><span>Fonts</span></a></li><li><a href=https://eric.swiftzer.net/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://eric.swiftzer.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://eric.swiftzer.net/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://eric.swiftzer.net/>首頁</a>&nbsp;»&nbsp;<a href=https://eric.swiftzer.net/posts/>Posts</a></div><h1 class=post-title>Photosphere</h1><div class=post-meta>July 31, 2016</div></header><div class=post-content><p>早前 Facebook 的 <a href=https://facebook360.fb.com/360-photos/>360 Photos</a> 令 Photosphre 流行起來。沒有 360 camera 的話，可以用<a href="https://play.google.com/store/apps/details?id=com.google.android.street">手機應用程式</a>駁相。不過用手機影相畫質會比較差。所以這次試試用相機拍攝 Photosphere。</p><p>以下是所需工具：</p><ul><li>有全手動模式的相機</li><li>魚眼鏡 / 廣角鏡</li><li>三腳架</li><li>Hugin</li><li>Photoshop</li><li>能修改檔案 XMP 的工具</li></ul><h2 id=器材>器材<a hidden class=anchor aria-hidden=true href=#器材>#</a></h2><p>按照 Google 的指引，用 DSLR 拍攝 Photosphere 的話，是需要用魚眼鏡。但因為我沒有魚眼鏡的關係，所以唯有用 14-42mm kit 鏡（135 等效焦距 28mm）拍攝。用魚眼鏡拍攝的好處是因為視角夠廣，拍攝張數少，後期駁相都會比較方便。但由於沒有魚眼鏡的關係所以拍了 70 多張相來接駁。拍攝時要調去全手動模式 (M mode)，對焦設成無限遠，ISO、光圈、快門、白平衡都要手動固定，否則接駁時可能會有明顥光暗差異。</p><p>緊記要用三腳架以確保位置固定在一個點。如果要講夠的話可以用全景雲台，但就算不用效果也是可以的。拍攝時要確保相片之間要預留足夠的重疊位置。<a href=http://photosphereviewer.net>PhotosphereViewer.net</a> 提供了一個建議可以作參考：相機垂直，分 7 行影，水平角度影 14 張，之後慢慢將相機角度調向天上分別影 12 張、6 張、1 張，然後向地面做相同動作。不過拍到底部時要拿走腳架才拍。</p><h2 id=後製>後製<a hidden class=anchor aria-hidden=true href=#後製>#</a></h2><p><a href=http://hugin.sourceforge.net/>Hugin</a> 是一個開源的全景圖接駁軟件，它能支援不同的投射方式 (projection)。它支援 Photosphere 的 2:1 equirectangular projection。</p><p><img loading=lazy src=hugin-stitcher.png alt="Panorama Stitcher"></p><p>開啟 Hugin 之後，可以先加入水平角度影的一行相片讓它自動接駁。用水平角度影的一行應該是最易接駁。留意要設定好鏡頭的焦距，因為它會按照焦距來將相片投射到球體內。如果相片見到腳架的話，可以Hugin 內置了不同的算法來尋找兩張圖的共通點，將相片加到 project 之後應該先用那些算法自動做一次先（揀選相片，然後按 Create control points 按鈕），如果效果不好才自己手動逐個共通點標註。留意揀選相片再按 Create control points 按鈕這個步驟要以人手揀選不同的相片組合再按 Create control points 按鈕。因為它有時不會尋找跨行相片的共通點。駁了大約一行後可以按一下 Optimize 部分的 calculate 按鈕，讓它計算相片的位置。</p><p><img loading=lazy src=hugin-mask.jpg alt="用 Mask 將腳架減去"></p><p>這個步驟的目標就是要「織網」：即是將不同的相片以共通點連接，連接不單止是同一行，還要跨行。否則相片不能接駁成球體。要查看「織網」的效果，按一下 Fast panorama preview 按鈕（頂部寫有 GL 的按鈕），再轉到 Layout tab 就可以看到。如果「織網」效果不滿意，可以返回 Panorama Stitcher 視窗再揀選未有連結的兩張圖，再按一下 Create control points 按鈕。如果一次過揀選太多圖片來找共通點的話可能「織網」時會有遺漏。</p><p><img loading=lazy src=hugin-layout.png alt="Fast panorama preview - layout"></p><p>之後可以轉到 Preview tab 預覧效果。如果滿意的話可以將圖片匯出。留意匯出的圖片太大的話可能會因記憶體不足而失敗。匯出完成後可以用 <a href=http://photosphereviewer.net>PhotosphereViewer.net</a> 預覽。</p><p><img loading=lazy src=hugin-fast-pano.jpg alt="Preview panorama"></p><p>預覽時可能會發現頂部和底部都不能完全填滿﹑還見到小小腳架，或者端點駁位特別明顯，但用 Photoshop 修補又很難。Equirectangular projection 的特點就是頂部 (zenith) 和底部 (nadir) 會嚴重變形，如果直接修改的話會非常困難。所以這時要用 <a href=http://www.andrewhazelden.com/blog/2012/11/domemaster-photoshop-actions-pack/>The Domemaster Photoshop Actions Pack</a> Photoshop action 將頂部和底部還原。</p><p>裝好 The Domemaster Photoshop Actions Pack 之後，開啟之前匯出好的全景相，然後複製多一個文件出來 (Image | Duplicate)。如果要修改底部的話，就要先將圖片 180 度反轉。之後在 Action 面板選擇「2:1 Equirectangular to Angular Fisheye」。還原後會變成一個圓形的圖片，這時就可以用平時慣用的工具（例如 Clone stamp tool）來修補。如果懶的話可以放一個圓形的圖案遮蓋住底部，圖案可以是你的 logo 或者指南針之類。改好之後就合併所有圖層，之後在 Action 面板選擇「Angular Fisheye to 2:1 Equirectangular」。圖片就會變成 equirectangular projection，這就可以將該圖片放回原先的全景圖內。留意相片尺寸不可以太大，否則 Photoshop 不能處理。還有做完 Angular Fisheye to 2:1 Equirectangular Action 後圖片會被拉高，只需在放上去原圖時將高度縮小一半就可以了。</p><p><img loading=lazy src=photoshop-angular-fisheye.jpg alt="The Domemaster Photoshop Actions Pack"></p><p>最後就是為全景圖加上 <a href=https://developers.google.com/streetview/spherical-metadata>Photosphere XMP metadata</a>。我自己就用 Adobe Bridge 的面板加上 data panel 來加工，但其實可以用其他改 EXIF 和 XMP 軟件修改。除了 Photosphere XMP metadata 外，還可以加上相片拍攝位置的座標，方便分享到 Google Maps、Facebook、Flickr 等等的網站。Photosphere XMP metadata 有一項叫 <code>PoseHeadingDegrees</code> 是用來指明北面是在那方，但在 Facebook 試過發現它好像沒有用到這個數值。所以最好的方法都是在 Hugin 裏調節好方向。只需在 Hugin 的 Fast panorama preview 視窗按「Move/Drag」tab，然後按住 Shift 的同時左右 drag 全景圖就可以調整方向，將北面的景放到整張全景點的正中央就可以了。下面就是完成品（因為我之前已經上載了，所以沒有再修正方向問題）：</p><iframe src="https://www.google.com/maps/embed?pb=!1m0!3m2!1szh-TW!2shk!4v1469931300840!6m8!1m7!1sF%3A-Dl2hloj8eUI%2FV4ErF85dxLI%2FAAAAAAABSqw%2FQHJcmz_BjvIzKiqmjXOCbEtIAH4GNTGfgCLIB!2m2!1d22.466044!2d114.0017085!3f226.9019464826737!4f-56.8869752417503!5f0.7820865974627469" width=100% height=600 frameborder=0 style=border:0 allowfullscreen></iframe><p>其實可以見到 Hugin 會駁錯，可能是因為用了太多相片去駁，加上可能 Hugin 算法找錯共通點（大廈外牆其實層層都差不多，差異主要是在窗門曬的衣服和冷氣機；地磚就更難駁）。如果要用人手修正 / 補加共通點會花太多時間。如果想大量拍攝 Photosphere 的話最好都是買一支魚眼鏡。</p><h2 id=參考>參考<a hidden class=anchor aria-hidden=true href=#參考>#</a></h2><ul><li><a href=http://making360.com/patching-nadir/>making360 - Patching Nadir</a></li><li><a href=https://developers.google.com/streetview/spherical-metadata>Photo Sphere XMP 中繼資料</a></li><li><a href=http://www.panotwins.de/technical/how-to-add-mandatory-photo-sphere-meta-data-to-an-equirectangular-image-photoshop-cc-2014/>How to add mandatory Photo Sphere meta data to an equirectangular image (Photoshop CC 2014)</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://eric.swiftzer.net/tags/photography/>Photography</a></li><li><a href=https://eric.swiftzer.net/tags/photosphere/>Photosphere</a></li><li><a href=https://eric.swiftzer.net/tags/photoshop/>Photoshop</a></li></ul><nav class=paginav><a class=prev href=https://eric.swiftzer.net/2016/08/android-app-git-commit-hash/><span class=title>« 上一篇</span><br><span>在 Android app 內顯示 Git commit hash</span></a>
<a class=next href=https://eric.swiftzer.net/2016/07/olympus-em10/><span class=title>下一篇 »</span><br><span>Olympus E-M10</span></a></nav></footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//efilm.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2022 <a href=https://eric.swiftzer.net/>EricLog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>